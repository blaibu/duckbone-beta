<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>view_lifecycle_extensions.js</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="bindable_field.html">bindable_field.js</a>
          <a class="source" href="bindable_view.html">bindable_view.js</a>
          <a class="source" href="collection.html">collection.js</a>
          <a class="source" href="core.js.html">core.js.erb</a>
          <a class="source" href="editable_view.html">editable_view.js</a>
          <a class="source" href="flashable_view.html">flashable_view.js</a>
          <a class="source" href="form_fields.html">form_fields.js</a>
          <a class="source" href="form_validations.html">form_validations.js</a>
          <a class="source" href="handlebars.html">handlebars.js</a>
          <a class="source" href="handlebars_extensions.html">handlebars_extensions.js</a>
          <a class="source" href="index.html">index.js</a>
          <a class="source" href="listable_view.html">listable_view.js</a>
          <a class="source" href="model.html">model.js</a>
          <a class="source" href="pageable_collection.html">pageable_collection.js</a>
          <a class="source" href="pageable_view.html">pageable_view.js</a>
          <a class="source" href="remoteable_view.js.html">remoteable_view.js.erb</a>
          <a class="source" href="routeable_application.html">routeable_application.js</a>
          <a class="source" href="simple_queue.html">simple_queue.js</a>
          <a class="source" href="stylizeable_view.html">stylizeable_view.js</a>
          <a class="source" href="syncable.html">syncable.js</a>
          <a class="source" href="template_registry.js.html">template_registry.js.erb</a>
          <a class="source" href="templateable_view.js.html">templateable_view.js.erb</a>
          <a class="source" href="validateable_field.html">validateable_field.js</a>
          <a class="source" href="view_lifecycle_extensions.html">view_lifecycle_extensions.js</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>view_lifecycle_extensions.js</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-2">&#182;</a>
        </div>
        <p>This module adds default initialize() and remove() methods to any View class.
These methods try to call all of the initializers on all other Duckbone mixins
that are present on the View class. These are called in the correct order, so
that everything instantiates smoothly, without the developer needing to write initialize().</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>All of the Duckbone mixins ending in -View also mix in this module,
as a dependency in their included() callback.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>These methods will not be set if the developer has previously defined them,
and mixing this in will have no effect.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>There are several callback hooks available that can be defined on the object:</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-6">&#182;</a>
        </div>
        <ul>
<li>beforeCreateChildViews() =&gt; called before ListView creates its children</li>
<li>beforeClone() =&gt; called before EditableView clones its model for editing</li>
<li>beforeTwirl() =&gt; called before TemplateableView calls twirl()</li>
<li>afterCreateForm() =&gt; called after EditableView renders its form elements</li>
<li>afterInitialize() =&gt; called after all other initializations are complete</li>
<li>beforeRemove() =&gt; called before the View is removed</li>
<li>afterRemove() =&gt; called after the View is removed</li>
</ul>

      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="kd">var</span> <span class="nx">defaultInitialize</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">tryMethod</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">])</span> <span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">tryMethods</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">methods</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">methods</span><span class="p">,</span> <span class="nx">tryMethod</span><span class="p">);</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">application</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">application</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isListableView</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tryMethods</span><span class="p">([</span>
        <span class="s1">&#39;beforeCreateChildViews&#39;</span><span class="p">,</span> <span class="c1">// User optionally defines this</span>
        <span class="s1">&#39;createChildViews&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bindCollectionEvents&#39;</span>
      <span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEditableView</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tryMethods</span><span class="p">([</span>
        <span class="s1">&#39;beforeClone&#39;</span><span class="p">,</span> <span class="c1">// User optionally defines this</span>
        <span class="s1">&#39;cloneModelForEditing&#39;</span><span class="p">,</span>
        <span class="s1">&#39;afterClone&#39;</span> <span class="c1">// User optionally defines this</span>
      <span class="p">])</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isTemplateableView</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tryMethods</span><span class="p">([</span>
        <span class="s1">&#39;beforeTwirl&#39;</span><span class="p">,</span> <span class="c1">// User optionally defines this</span>
        <span class="s1">&#39;twirl&#39;</span>
      <span class="p">])</span>
    <span class="p">}</span>
    <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;createChildren&#39;</span><span class="p">);</span> <span class="c1">// User optionally defines this</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isStylizeableView</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;applyStyles&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isBindableView</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;bindAttributes&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEditableView</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">tryMethods</span><span class="p">([</span>
        <span class="s1">&#39;bindModelSyncEvents&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createForm&#39;</span><span class="p">,</span>
        <span class="s1">&#39;afterCreateForm&#39;</span><span class="p">,</span> <span class="c1">// User optionally defines this</span>
        <span class="s1">&#39;bindFormSubmit&#39;</span>
      <span class="p">]);</span>
    <span class="p">}</span>
    <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;afterInitialize&#39;</span><span class="p">);</span> <span class="c1">// User optionally defines this</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">defaultRemove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">tryMethod</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">])</span> <span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isEditableView</span><span class="p">)</span> <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;expireClone&#39;</span><span class="p">);</span>
    <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;beforeRemove&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isBindableView</span><span class="p">)</span> <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;removeWeakBindings&#39;</span><span class="p">);</span>
    <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">tryMethod</span><span class="p">(</span><span class="s1">&#39;afterRemove&#39;</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">Duckbone</span><span class="p">.</span><span class="nx">ViewLifecycleExtensions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">hasViewLifecycleExtensions</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>

    <span class="nx">included</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;initialize&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">defaultInitialize</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;remove&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">defaultRemove</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">();</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
